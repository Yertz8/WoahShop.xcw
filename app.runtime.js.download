$(document).ready(function(){if(window.$rdcw.isLogin){window.rdcwTaskId=null;window.fetchInfo=function(){if(window.$rdcw.noClipMode){clearInterval(window.rdcwTaskId);return;}
$.get('/api/users/info').done(function(res){if(res.status){window.$rdcw.userInfo=res.data;var amount=parseInt(res.data.points).toFixed(2).toString();$('[data-rdcw-points]').text(amount.concat(' ','‡∏û‡πâ‡∏≠‡∏¢‡∏ó‡πå'));}});}
window.rdcwTaskId=setInterval(fetchInfo,5000);fetchInfo();}
window.rdcwAjax=function(jqXHR){return jqXHR.done(function(res){swal.fire({icon:(res.status)?'success':'error',title:(res.status)?'‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à':'‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',text:(typeof res.message!='undefined'&&res.message.length>0)?res.message:'‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'});}).fail(function(jqXHR){if(typeof jqXHR.responseJSON=='object'){var res=jqXHR.responseJSON;swal.fire({icon:'error',title:'‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',text:(typeof res.message!='undefined'&&res.message.length>0)?res.message:'‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'});}else{swal.fire({icon:'error',title:'‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',text:jqXHR.statusText+' ('+jqXHR.status+')'});}})};$('[data-rdcw-credit]').on('dblclick',function(e){e.preventDefault();return swal.fire({title:'üöß RDCW',html:['Made by <a href="https://rdcw.in.th" target="_blank">RDCW</a>','Frontend by <a href="https://fb.me/studiomaila" target="_blank">Studio Maila</a>','Backend by <a href="https://github.com/DearTanakorn" target="_blank">DearTanakorn</a>'].join('<br/>'),showCloseButton:false,showCancelButton:false,showConfirmButton:false,showClass:{popup:''},hideClass:{popup:''}});});$('[data-requires-auth]').on('click',function(e){if(!window.$rdcw.isLogin){e.preventDefault();window.location.href='/signin';}});if($('[data-elem="shop/idpass"]').length>0){$('#form_0').css({maxHeight:1,opacity:0});$('#loading_0').fadeIn(100);setTimeout(function(){$.get('/api/idpass/price').done(function(res){if(res.data.length>0){$(res.data).each(function(i,val){let newElem=$('<option></option>');newElem.attr('data-index',i);newElem.attr('data-pid',val.id);newElem.attr('data-ppw',val.price);newElem.attr('value',val.id);newElem.html(val.name+' &mdash; ‡∏£‡∏≤‡∏Ñ‡∏≤ '+val.price.toFixed(2)+' ‡∏ø');$('#selection_project').append(newElem);});}
$('#loading_0').fadeOut(0);$('#form_0').css({maxHeight:'initial'}).animate({opacity:1},500);}).fail(window.rdcwAjaxErrorHandler);},300);}
if($('[data-elem="history/idpass"]').length>0){$('#table').DataTable({responsive:true,ajax:'/api/shop/idpass_history',dataSrc:'data',columns:[{data:'id'},{data:'name'},{data:'username'},{data:null,render:function(data,type,row){var STATUS=['‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£','‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß','‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß'];return STATUS[parseInt(data.status)];}},{data:'reason',render:function(data,type,row){return data||'-'}},{data:'timestamp',render:function(data){return new Date(data).toLocaleString('th-TH')}},]});}
$('[data-purchase]').on('click',function(e){e.preventDefault();if(!window.$rdcw.isLogin){window.location.href='/signin';return;}
$(e.target).attr('disabled','disabled');$(e.target).addClass('disabled');var pid=$(this).data('product-id');var price=$(this).data('product-price');Swal.fire({icon:'question',title:'‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà???',html:'‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞<br/>‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤ <b>'+price+' ‡∏û‡πâ‡∏≠‡∏¢‡∏ó‡πå</b> ?',showDenyButton:true,confirmButtonText:'‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',denyButtonText:'‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',}).then(function(result){if(result.isConfirmed){return $.post('/api/shop/buy/'.concat(pid)).done(function(res){if(res.status){swal.fire({icon:'success',title:'‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',text:'‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠'}).then(function(){window.location.href='/history/shop';});}else{swal.fire({icon:'error',title:'‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ',text:(typeof res.message!='undefined'&&res.message.length>0)?res.message:'‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'});}}).fail(function(jqXHR){if(typeof jqXHR.responseJSON=='object'){var res=jqXHR.responseJSON;swal.fire({icon:'error',title:'‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',text:(typeof res.message!='undefined'&&res.message.length>0)?res.message:'‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'});}else{swal.fire({icon:'error',title:'‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',text:jqXHR.statusText+' ('+jqXHR.status+')'});}}).always(function(){$(e.target).removeAttr('disabled');$(e.target).removeClass('disabled');});}
$(e.target).removeAttr('disabled');$(e.target).removeClass('disabled');});});$('[data-form-func="common"]').on('submit',function(e){e.preventDefault();rdcwAjax($.ajax({url:$(this).data('form-action'),method:$(this).data('form-method'),data:$(this).serialize(),beforeSend:function(){$('input').attr('readonly','readonly')
$('button').attr('disabled','disabled')}})).always(function(){$('input').removeAttr('readonly');$('button').removeAttr('disabled');e.target.reset();grecaptcha.reset();});});$('[data-form-func="multipart"]').on('submit',function(e){e.preventDefault();rdcwAjax($.ajax({url:$(this).data('form-action'),method:$(this).data('form-method'),data:new FormData($(this).get(0)),processData:false,contentType:false,beforeSend:function(){$('input').attr('readonly','readonly')
$('button').attr('disabled','disabled')}})).always(function(){$('input').removeAttr('readonly');$('button').removeAttr('disabled');e.target.reset();grecaptcha.reset();});});$('[data-form-func="auth"]').on('submit',function(e){e.preventDefault();$.ajax({url:$(this).data('form-action'),method:$(this).data('form-method'),data:$(this).serialize(),beforeSend:function(){$('input').attr('readonly','readonly')
$('button').attr('disabled','disabled')}}).done(function(res){if(!res.status){swal.fire({icon:'error',title:'‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',text:res.message});return;}
window.location.href='/';}).always(function(){$('input').removeAttr('readonly')
$('button').removeAttr('disabled')
grecaptcha.reset();});});if($('[data-elem="history/shop"]').length>0){$('#table').DataTable({responsive:true,ajax:'/api/shop/history',dataSrc:'data',columns:[{data:'id'},{data:'package_name'},{data:'package_info'},{data:'date',render:function(data){return new Date(data).toLocaleString('th-TH')}},]});}
if($('[data-elem="history/topup"]').length>0){$('#table').DataTable({responsive:true,ajax:'/api/topup/history',dataSrc:'data',columns:[{data:'id'},{data:'type'},{data:'code'},{data:'amount'},{data:'date',render:function(data){return new Date(data).toLocaleString('th-TH')}},]});}
if($('input[type="password"]').length>0){$('input[type="password"]').each(function(){var pwd=$(this);let elem=$('<span class="password-eye"></span>');let eye=$('<i class="fas fa-eye"></i>');eye.on('click',function(){if(pwd.attr('type')=='password'){pwd.attr('type','text');}else{pwd.attr('type','password');}
this.classList.toggle('fa-eye-slash');});eye.appendTo(elem);elem.insertAfter(this);});}
if($('#table').length>0){$('#table').attr('width','100%');}
if($('.g-recaptcha').length>0){var scaleRecaptcha=function(){var width=$('.g-recaptcha').parent().width();if(width<302){var scale=width/302;$('.g-recaptcha').css('transform','scale('+scale+')');$('.g-recaptcha').css('-webkit-transform','scale('+scale+')');$('.g-recaptcha').css('transform-origin','0 0');$('.g-recaptcha').css('-webkit-transform-origin','0 0');}}
$(window).on('resize',function(e){scaleRecaptcha();});scaleRecaptcha();}});